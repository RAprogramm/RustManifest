# Методология анализа кода и поиска уязвимостей

Комплексное руководство по code review, поиску уязвимостей и слабых мест в коде.

## Структура методологии

### 1. [Безопасность и уязвимости](./security-vulnerabilities.md)
- Криптография и аутентификация
- Инъекции и валидация данных
- Атаки типа replay, CSRF, XSS
- Утечки данных и секретов
- Практические примеры

### 2. [Производительность](./performance-issues.md)
- Поиск узких мест
- Неэффективные аллокации
- Дублирование операций
- Оптимизация алгоритмов
- Профилирование

### 3. [Качество кода](./code-quality.md)
- Дублирование кода (DRY)
- Читаемость и поддерживаемость
- Обработка ошибок
- Тестирование
- Документация

### 4. [Архитектура](./architecture.md)
- Single Responsibility Principle
- Модульность
- Зависимости
- Переиспользование
- Масштабируемость

### 5. [Rust-специфика](./rust-specific.md)
- Memory safety
- Ownership и borrowing
- Panic vs Result
- Zero-cost abstractions
- Unsafe код

### 6. [Реальные примеры](./examples.md)
- Примеры из проектов
- До/После рефакторинга
- Измеримые улучшения

## Общий подход к code review

### Этап 1: Первичный осмотр (5-10 минут)
1. Понять общую структуру изменений
2. Прочитать commit message и PR description
3. Оценить масштаб изменений

### Этап 2: Безопасность (15-20 минут)
1. Поиск уязвимостей (см. security-vulnerabilities.md)
2. Проверка валидации входных данных
3. Анализ криптографии и аутентификации
4. Проверка на утечки секретов

### Этап 3: Корректность (10-15 минут)
1. Логика работает правильно?
2. Обработка всех edge cases
3. Правильная обработка ошибок
4. Тесты покрывают функционал

### Этап 4: Производительность (10 минут)
1. Поиск неэффективных операций
2. Лишние аллокации
3. Дублирование работы
4. Алгоритмическая сложность

### Этап 5: Качество (10 минут)
1. Читаемость
2. Дублирование
3. Именование
4. Документация

### Этап 6: Архитектура (5-10 минут)
1. Соответствие принципам SOLID
2. Модульность
3. Переиспользование
4. Техдолг

## Быстрый чеклист

### Критические проблемы (блокируют merge)
- [ ] Уязвимости безопасности
- [ ] Утечки секретов (пароли, токены, ключи)
- [ ] Panic в production коде
- [ ] Неправильная обработка ошибок
- [ ] Отсутствие тестов для критичной логики

### Важные проблемы (требуют исправления)
- [ ] Неэффективные операции (O(n²) вместо O(n))
- [ ] Дублирование кода (>3 повторений)
- [ ] Отсутствие валидации входных данных
- [ ] Magic numbers и magic strings
- [ ] Недокументированный публичный API

### Желательные улучшения
- [ ] Рефакторинг для читаемости
- [ ] Дополнительные тесты
- [ ] Улучшение документации
- [ ] Оптимизация производительности

## Инструменты

### Автоматические проверки
- **Clippy** - статический анализатор для Rust
- **cargo audit** - проверка зависимостей на уязвимости
- **cargo deny** - проверка лицензий и безопасности
- **cargo tarpaulin** - покрытие тестами
- **cargo bench** - бенчмарки производительности

### Ручной анализ
- **git diff** - просмотр изменений
- **ripgrep (rg)** - поиск паттернов в коде
- **tokei** - статистика по коду
- **cargo tree** - дерево зависимостей

## Приоритизация

### Высокий приоритет
1. Безопасность
2. Корректность
3. Критические баги

### Средний приоритет
4. Производительность (если есть проблемы)
5. Качество кода
6. Тестирование

### Низкий приоритет
7. Стиль кода (если есть автоформаттер)
8. Мелкие рефакторинги
9. Документация (если не public API)

## Принципы эффективного review

1. **Будь конкретным**: "Здесь возможна SQL-инъекция в строке 42" вместо "Проблемы с безопасностью"
2. **Предлагай решения**: Не просто "Это медленно", а "Можно использовать HashMap вместо Vec::find"
3. **Объясняй почему**: "Это приведет к replay attack, потому что..."
4. **Используй метрики**: "Это увеличит аллокации на 40%"
5. **Будь позитивным**: Отмечай хорошие решения тоже

## Следующие шаги

Изучи каждый раздел подробно:
1. Начни с [security-vulnerabilities.md](./security-vulnerabilities.md) - это самое важное
2. Затем [performance-issues.md](./performance-issues.md) - для production-ready кода
3. Изучи [rust-specific.md](./rust-specific.md) - специфика языка
4. Практикуйся на [examples.md](./examples.md) - реальные кейсы
