# Quick Reference - –®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ Code Review

–ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (–±–ª–æ–∫–∏—Ä—É—é—Ç merge)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
```bash
# –ü–æ–∏—Å–∫ —Å–µ–∫—Ä–µ—Ç–æ–≤
rg "(?i)(password|secret|api_key|token|private_key).*=.*['\"]" --type rust

# –ü–æ–∏—Å–∫ SQL –∏–Ω—ä–µ–∫—Ü–∏–π
rg "format!.*SELECT|execute.*&format!" --type rust

# –ü–æ–∏—Å–∫ command –∏–Ω—ä–µ–∫—Ü–∏–π
rg "Command::new.*format!" --type rust
```

**–ß–µ–∫-–ª–∏—Å—Ç:**
- [ ] –ù–µ—Ç hardcoded credentials
- [ ] SQL –∑–∞–ø—Ä–æ—Å—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω—ã
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] auth_date –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç replay attacks
- [ ] –ù–µ—Ç —Å–ª–∞–±—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ (MD5, SHA1)

---

### Panic –≤ production
```bash
# –ù–∞–π—Ç–∏ –≤—Å–µ unwrap/expect/panic
rg "\.unwrap\(\)|\.expect\(|panic!" --type rust --glob '!tests'
```

**–ü—Ä–∞–≤–∏–ª–æ:** –ù–µ—Ç panic –≤ production –∫–æ–¥–µ (—Ç–æ–ª—å–∫–æ Result).

### let-else vs map_err —Ü–µ–ø–æ—á–∫–∏
```rust
// ‚ùå –î–ª–∏–Ω–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏
let value = parse(input).map_err(E::A)?.validate().map_err(E::B)?;

// ‚úÖ –ß–∏—Ç–∞–µ–º—ã–π –∫–æ–¥
let Ok(value) = parse(input) else { return Err(E::A); };
let Ok(value) = value.validate() else { return Err(E::B); };
```

**–ü—Ä–∞–≤–∏–ª–æ:** let-else –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —à–∞–≥–æ–≤, map_err ‚Äî –¥–ª—è –æ–¥–Ω–æ–≥–æ.

---

## ‚ö° –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
```bash
# –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π O(n¬≤))
rg "for.*\{[\s\S]{1,200}for" --type rust

# Vec::new –±–µ–∑ with_capacity
rg "Vec::new\(\)" --type rust

# contains –≤ —Ü–∏–∫–ª–µ
rg "\.contains\(" --type rust

# –õ–∏—à–Ω–∏–µ clone
rg "\.clone\(\)" --type rust
```

**–í–æ–ø—Ä–æ—Å—ã:**
- –ü–∞—Ä—Å–∏–Ω–≥ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–¥–∏–Ω —Ä–∞–∑?
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è with_capacity –¥–ª—è Vec?
- –ù–µ—Ç O(n¬≤) –≥–¥–µ –º–æ–∂–Ω–æ O(n)?
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏—Ç–µ—Ä–∞—Ç–æ—Ä—ã –≤–º–µ—Å—Ç–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö Vec?

---

## üìã –ß–µ–∫–ª–∏—Å—Ç –Ω–∞ 5 –º–∏–Ω—É—Ç

### 1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (2 –º–∏–Ω)
- [ ] –ù–µ—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –∫–æ–¥–µ
- [ ] –ù–µ—Ç unwrap/expect
- [ ] –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è
- [ ] –ù–µ—Ç SQL/Command –∏–Ω—ä–µ–∫—Ü–∏–π

### 2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (1 –º–∏–Ω)
- [ ] –ù–µ—Ç –æ—á–µ–≤–∏–¥–Ω—ã—Ö O(n¬≤)
- [ ] –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] Vec::with_capacity –≥–¥–µ –Ω—É–∂–Ω–æ

### 3. –ö–∞—á–µ—Å—Ç–≤–æ (2 –º–∏–Ω)
- [ ] –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ (> 3 —Ä–∞–∑)
- [ ] –§—É–Ω–∫—Ü–∏–∏ < 50 —Å—Ç—Ä–æ–∫
- [ ] –ù–æ—Ä–º–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- [ ] –ï—Å—Ç—å —Ç–µ—Å—Ç—ã –Ω–∞ –Ω–æ–≤—É—é –ª–æ–≥–∏–∫—É

---

## üîç –ß–∞—Å—Ç—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–æ–±–ª–µ–º

### 1. Replay Attack
```rust
// ‚ùå –ü–õ–û–•–û
fn validate(raw: &str, hash: &str) -> bool {
    compute_hash(raw) == hash  // –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Ä–µ–º–µ–Ω–∏!
}

// ‚úÖ –•–û–†–û–®–û
fn validate(raw: &str, hash: &str, max_age: u64) -> bool {
    check_timestamp(raw, max_age) && compute_hash(raw) == hash
}
```

### 2. Double Parsing
```rust
// ‚ùå –ü–õ–û–•–û - –ø–∞—Ä—Å–∏–º –¥–≤–∞–∂–¥—ã
fn validate(raw: &str) -> bool {
    let data = parse(raw);  // 1
    check(data);
    hash(raw)  // parse() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Å–Ω–æ–≤–∞! 2
}

// ‚úÖ –•–û–†–û–®–û
fn validate(raw: &str) -> bool {
    let data = parse(raw);  // 1 —Ä–∞–∑
    check(&data);
    hash(&data)  // –ø–µ—Ä–µ–¥–∞–µ–º —Å—Å—ã–ª–∫—É
}
```

### 3. N+1 Query
```rust
// ‚ùå –ü–õ–û–•–û
for id in ids {
    let user = db.get(id).await;  // N –∑–∞–ø—Ä–æ—Å–æ–≤
}

// ‚úÖ –•–û–†–û–®–û
let users = db.get_many(ids).await;  // 1 –∑–∞–ø—Ä–æ—Å
```

### 4. Unnecessary Clone
```rust
// ‚ùå –ü–õ–û–•–û
fn process(data: Vec<String>) -> usize {
    data.len()  // –ó–∞–±–∏—Ä–∞–µ—Ç ownership –∑—Ä—è
}

// ‚úÖ –•–û–†–û–®–û
fn process(data: &[String]) -> usize {
    data.len()
}
```

---

## üõ†Ô∏è –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º
```bash
# –í—Å–µ unwrap/expect
rg "\.unwrap\(\)|\.expect\(" --type rust --glob '!tests'

# Magic numbers
rg "\b[0-9]{3,}\b" --type rust

# TODO/FIXME
rg "TODO|FIXME" --type rust

# –î–ª–∏–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (>50 —Å—Ç—Ä–æ–∫)
# (–Ω—É–∂–µ–Ω —Å–∫—Ä–∏–ø—Ç –∏–ª–∏ —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
```

### –ú–µ—Ç—Ä–∏–∫–∏
```bash
# –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
cargo tarpaulin --out Xml

# Clippy
cargo clippy -- -D warnings

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
cargo +nightly fmt --check

# –¢–µ—Å—Ç—ã
cargo test

# –ë–µ–Ω—á–º–∞—Ä–∫–∏
cargo bench
```

---

## üìä –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è

### MUST FIX (–±–ª–æ–∫–∏—Ä—É–µ—Ç merge)
1. **–£—è–∑–≤–∏–º–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
2. **Panic –≤ production**
3. **–õ–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏**
4. **–°–ª–æ–º–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**

### SHOULD FIX (–ø–µ—Ä–µ–¥ merge)
5. **–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (>10% –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è)**
6. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ (>3 —Ä–∞–∑)**
7. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω–æ–π –ª–æ–≥–∏–∫–∏**

### NICE TO HAVE (–º–æ–∂–Ω–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º PR)
8. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏**
9. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã**
10. **–£–ª—É—á—à–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**

---

## üí¨ –ö–∞–∫ –ø–∏—Å–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ review

### ‚ùå –ü–ª–æ—Ö–æ
- "–≠—Ç–æ –ø–ª–æ—Ö–æ"
- "–ü–µ—Ä–µ–¥–µ–ª–∞–π"
- "–¢—É—Ç –ø—Ä–æ–±–ª–µ–º–∞"

### ‚úÖ –•–æ—Ä–æ—à–æ
- "–ó–¥–µ—Å—å –≤–æ–∑–º–æ–∂–Ω–∞ SQL-–∏–Ω—ä–µ–∫—Ü–∏—è –≤ —Å—Ç—Ä–æ–∫–µ 42. –ò—Å–ø–æ–ª—å–∑—É–π –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å: `query_as!(...)`"
- "–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ü–∏–∫–ª–µ, —á—Ç–æ –¥–∞–µ—Ç O(n¬≤). –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HashMap –¥–ª—è O(n)"
- "–ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ auth_date - —É—è–∑–≤–∏–º–æ—Å—Ç—å –∫ replay attack. –î–æ–±–∞–≤—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Telegram"

**–§–æ—Ä–º—É–ª–∞:**
1. **–ß—Ç–æ** –Ω–µ —Ç–∞–∫
2. **–ü–æ—á–µ–º—É** —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞
3. **–ö–∞–∫** –∏—Å–ø—Ä–∞–≤–∏—Ç—å (–∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã)

---

## üéØ –§–æ–∫—É—Å –ø–æ –≤—Ä–µ–º–µ–Ω–∏

### 5 –º–∏–Ω—É—Ç - –ö—Ä–∏—Ç–∏—á–Ω–æ–µ
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- Panic/unwrap
- –û—á–µ–≤–∏–¥–Ω—ã–µ –±–∞–≥–∏

### 15 –º–∏–Ω—É—Ç - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π
- –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
- –õ–∏—à–Ω–∏–µ –∞–ª–ª–æ–∫–∞—Ü–∏–∏

### 30 –º–∏–Ω—É—Ç - –î–æ–±–∞–≤–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å
- –¢–µ—Å—Ç—ã
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### 45 –º–∏–Ω—É—Ç - –¢—â–∞—Ç–µ–ª—å–Ω—ã–π review
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- Edge cases –≤ —Ç–µ—Å—Ç–∞—Ö
- –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å

---

## üìù –®–∞–±–ª–æ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è

```markdown
## Security
- [ ] auth_date validation missing (replay attack) - line 42
- [ ] SQL injection in `get_user()` - line 156

## Performance
- [ ] Double parsing of initData - lines 50, 75
- [ ] O(n¬≤) in `remove_duplicates()` - line 200

## Quality
- [ ] Hash computation duplicated 3 times - suggest extract function
- [ ] Missing tests for error cases

## Suggestions
- Consider using HashMap instead of Vec::find for O(1) lookups
- Add doc comments for public API
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–û—Ç–∫—Ä–æ–π PR** ‚Üí —Å–º–æ—Ç—Ä–∏ diff
2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** (5 –º–∏–Ω):
   - `rg` —Å–µ–∫—Ä–µ—Ç—ã, unwrap, –∏–Ω—ä–µ–∫—Ü–∏–∏
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** (5 –º–∏–Ω):
   - –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, O(n¬≤), –∞–ª–ª–æ–∫–∞—Ü–∏–∏
4. **–ö–∞—á–µ—Å—Ç–≤–æ** (5 –º–∏–Ω):
   - DRY, —á–∏—Ç–∞–µ–º–æ—Å—Ç—å, —Ç–µ—Å—Ç—ã
5. **–ü–∏—à–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** - –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –∏ —Å —Ä–µ—à–µ–Ω–∏—è–º–∏
6. **Approve –∏–ª–∏ Request Changes**

**–ò—Ç–æ–≥–æ: 15-20 –º–∏–Ω—É—Ç –Ω–∞ –æ–±—ã—á–Ω—ã–π PR**

---

## üîó –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Å–º–æ—Ç—Ä–∏ –≤:
- [security-vulnerabilities.md](./security-vulnerabilities.md)
- [performance-issues.md](./performance-issues.md)
- [code-quality.md](./code-quality.md)
- [rust-specific.md](./rust-specific.md)
- [examples.md](./examples.md)
